# 第二章 从硬件到软件的层级概述



这一章将告诉你软件和硬件是如何交互的，以及如何在物理层面上表示软件。



## 2.1 一个 bit 的物理级实现



所有的电子设备，无论简单还是复杂，都是操作电流去达到预期的效果的。计算机当然不例外。我们写软件的时候，实际上，我们间接操纵了电流。只有这样，底层的机器才能发挥作用。



为了理解这个过程，我们假想一个简单的电灯泡。一个电灯泡可以有两种状态开或者关，关意味着 0 开意味着 1。



![](https://upload-images.jianshu.io/upload_images/15548795-c75443a3636baf56.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)



然而，这样有个问题，**开关是人操纵的**。我们需要的是一个根据电压的自动开关。为了能够自动改变电子信号，有三个牛 b 的人（William Shockley, John Bardeen and Walter Brattain）发明了一种叫做「*晶体管（transistor）*」 的设备。**这个设备开启了整个计算机行业**。



实际上，晶体管就是电阻。电阻的值可以根据输入电压的值变化而变化。



有这样一个特性，晶体管就可以变成一个电流放大器（高电压，低阻值），根据电压的大小，也可以是一个电信号的开关（阻隔或非阻隔）。

0 v 的时候没有电流可以通过，因此它就像一个开关打开的电路（灯泡关闭）因为电阻的值足够阻隔电流。同样的是，在 3.5 V 电流可以通过晶体管，因为电阻值下降了，有效地实现电子流动，因此就像一个开关闭合的电路。





一个 bit 有两种状态：0 或者 1。与电灯泡相同，可以被关闭和打开。bit 来自电流：bit 0 用 0v（无电流）表示，bit 1用 3.5V 到 5V（有电流）表示。晶体管可以正确地实现 bit，因为它可以根据电压调节电流。



### 2.1.1 MOSFET 晶体管



被发明创造出来的晶体管打开了一个全新的微型数字设备的世界。在这之前，真空管（仅仅比灯泡好点）被用来表示 0 和 1，需要人们手动打开或者关闭。



1959 年，Dawon Kahng 和 Martin M. (John) Atalla 在贝尔实验室中发明了 MOSFET 晶体管（M etal–Oxide–Semiconductor Field-Effect MOSFET T ransistor）。这种晶体管更好更适合。



### 2.2 超越晶体管：数字逻辑门



所有数字设备都设计有逻辑门。*逻辑门（logic gate）* 是能够实现 bool 类型函数的设备。每一个逻辑门都包含输入和输出。所有的计算机都是由非常多个逻辑门组合起来的，也就是由非常多的 bool 型函数构成。

![](https://upload-images.jianshu.io/upload_images/15548795-0914b1be96585bb4.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

### 2.2.1 逻辑门背后的原理

*逻辑门（Logic gates）*仅接受二进制和输出二进制。换句话说，逻辑门就是转换二进制值的函数。幸好存在着处理二进制数的数学理论——「布尔代数（Boolean Algebra）」



当逻辑门能够实现一些特定的布尔函数的时候，所有的布尔函数集合在功能上是完整的，只要这些特定的布尔函数能够构造其他的布尔函数。



不久，有人（Charles Sanders Peirce）就证明了 NOR 或者 NAND 就能组合其他所有的布尔函数。布尔函数的可以用逻辑门表示，也就是说，NAND 或者 NOR 的逻辑门就可以表示其他所有的逻辑门。



最简单的逻辑门 CMOS 电路可以实现一个逆变器（NOT gates）。几个逆变器在一起就能构成一个 NAND 门。有了 NAND 门我们就能创建所有的逻辑门了。这就是为什么晶体管的发明，以及 CMOS 电路彻底改变了计算机行业。



我们应该要意识到，布尔函数有多么的牛逼。



![](https://upload-images.jianshu.io/upload_images/15548795-6f4ded1a20349a64.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)



### 逻辑门的实现：CMOS 电路



底层中每一个逻辑们都是一个叫做的 CMOS（Complementary CMOS MOSFET）电路。CMOS 包含两个晶体管。NMOS 和 PMOS。最简单的 CMOS 电路就是一个逆转器或者 NOT 门：



![](https://upload-images.jianshu.io/upload_images/15548795-ba206b6a07617803.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)



NOT 门完成了，NAND 门也就不远了：



![](https://upload-images.jianshu.io/upload_images/15548795-4de3f5e85a50347b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)





有了 NAND 门，其他门也就有了。就如图示的那样如此简单的电路就能实现一个逻辑操作。真的是太神奇了。在我们的编程语言中，NOT 操作 就是 ~。& 就是 AND 门。代码并不是跑在神秘的魔法盒上。相反，代码的执行是非常清晰与透明的，就是在小小的硬件电路上运行。