# 第三章 计算机架构



要编写较底层的代码，程序员必须了解计算机的架构。它类似于在软件框架中编写程序时，他必须知道框架会能够解决什么样的问题，以及如何通过其提供的接口来使用框架。



但在了解计算机体系结构的定义之前，我们必须了解计算机究竟是什么，因为许多人仍然认为计算机是我们放在桌面上的常见计算机，或者充其量只是服务器。计算机有各种形状和大小，人们从来不会想到那就是计算机，也不会想到代码可以跑在这样的设备上。





## 3.1 什么是计算机



计算机是一种硬件设备，至少包括处理器（CPU），计算机存储设备和输入/输出接口。所有的计算机都可以分为两种类型



+ 单用途计算机

  单用途计算机是一种为特定任务建立在硬件水平的计算机。举栗子：

  + 单用途：encoder / decoder；时间，图像/视频/音频处理器



+ 通用用途计算机

  通用用途计算机是一种可编程的（不用修改它的硬件）计算机。这种计算机用来模仿各种单用途计算机的功能



### 3.1.1 Server



服务器是一款通用的高性能计算机，具有巨大的服务器资源，可为广大客户提供大规模服务。客户是指那些通过个人设备连接服务器的人。



![](https://upload-images.jianshu.io/upload_images/15548795-b0cce0b1df47242e.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)



### 3.1.2 台式计算机



台式计算机是一台通用计算机，具有为人类用户设计的输入和输出系统。具有足够给个人使用的资源。

输入系统通常包括鼠标和键盘，而输出系统通常包括一个可以显示大量像素的显示器。计算机封装在一个底盘中，足以放置各种计算机组件，如处理器，主板，电源，硬盘等。



![](https://upload-images.jianshu.io/upload_images/15548795-d88c1af1812179f1.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)



### 3.1.3 便携式计算机



便携式计算机类似于具有较少资源移动计算机的台式计算机，但可以随身携带。



![](https://upload-images.jianshu.io/upload_images/15548795-97d1dd2b71325724.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)



### 3.1.4 游戏机



游戏机类似于台式计算机，但针对游戏进行了优化。游戏控制台的输入系统不是键盘和鼠标，而是游戏控制器，它是一个带有几个用于控制屏幕上物体的按钮的设备;输出系统是显示屏。



游戏机使用定制的处理器和图形处理器，但类似于台式计算机。例如，第一台 Xbox 使用定制的 Intel PentiumIII 处理器



![](https://upload-images.jianshu.io/upload_images/15548795-1a7a2304bf0202fd.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)



手持游戏机与游戏机类似，但是手持游戏机把整个输入输出设备和计算机都包在了一起。



![](https://upload-images.jianshu.io/upload_images/15548795-975bf41d19884686.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)





### 嵌入式计算机



嵌入式计算机是单板或单芯片计算机。为整合到大型硬件中设计，只有有限的资源。



*微控制器*是一种嵌入式计算机，用于控制微控制器的其他硬件设备。微控制器安装在芯片上。微控制器是通用计算机，但资源有限，因此它只能执行一项或几项专门任务。这些计算机仅用于一个目的，但它们仍然是通用的，因为它们可以根据需要对它们进行编程以执行不同的任务，而无需更改底层硬件。



![](https://upload-images.jianshu.io/upload_images/15548795-c5f80f20d098f228.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)



另一种类型的嵌入式计算机是 system-on-chip。system-on-chip 是单个芯片上的完整计算机。



虽然微控制器也安装在芯片上，但其目的却不同。微控制器通常更简单并且在硬件资源方面更受限制，因为在运行时仅专门用于一个目的。



而 system-on-chip 是可以用于多种目的的通用计算机。system-on-chip 可以像常规台式计算机一样运行，能够加载操作系统并运行各种应用程序。片上系统通常存在于智能手机中，例如在 Ipad2 和iPhone 4S 中使用的 Apple A5 SoC，或在许多 Android 手机中使用的 Qualcomm Snapdragon。



![](https://upload-images.jianshu.io/upload_images/15548795-3f1bdeb958beef87.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)



无论是微处理器还是 system-on-chip。他们都需要搭载在一个环境上，以连接其他设备。这种环境是一种电路板叫做 PCB（Printed Circuit Board）



印刷电路板（PCB）包含线能够使电子设备上流动。没有 PCB 也就不能联合所有设备，也就不能创建一个更大的设备。



嵌入式设备，是大型设备的一份子，帮助大型设备在更高层次的完成更高目标。给嵌入式设备写代码就叫做嵌入式编程。嵌入计算机被用来自动控制像电动工具，植入医疗设备，办公设备，引擎控制系统，家电，远程控制系统和其他嵌入式系统。





老实说，微处理器和 system-on-chip 的界限很模糊。如果硬件保持升级，那么微处理器可以得到足够的资源跑一个操作系统，用来处理多个特定的任务。相反，system-on-chip 也有足够的能力胜任微控制器的任务。



然而，把 system-on-chip 当做微控制器真的不是一个性价比很高的选择，而且会浪费很多硬件资源。因为给微控制器写软件会需要一些计算资源。



### 3.1.6  可编程门阵列 （Field－Programmable Gate Array）



可编程门阵列 （FPGA）是一种包含一组可重新定制门的硬件。也就是说，当这个硬件从娘胎里出来以后，它的电路结构还是可编程的。想想之前的章节，每一个 74HC00 芯片可以被当做一个门。一个复杂的设备可以由多个 74HC00 芯片组合成。



相似的是，每一个 FPGA 设备。包含成百上千的芯片，这些芯片叫做逻辑块（logic blocks）。这是一种比 74HC00 复杂的多的芯片，它也可以实现布尔逻辑函数（Boolean logic function）。这些连在一起的逻辑块能够创建高级硬件的功能。这些高级的功能通常是一种需要高速处理的专用算法。



![](https://upload-images.jianshu.io/upload_images/15548795-637076829ce9fe7d.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

数字设备可以通过组合逻辑门来设计，不需要管实际的实际的电路部件，因为物理电路只是多个 CMOS 电路。数字硬件，包括计算机中的各种组件，是通过编写代码而设计的，就像常规程序员一样，通过使用语言来描述门是如何连接在一起的。这种语言称为**「硬件描述语言」**（Hardware Description Language）。之后，硬件描述被编译为连接的电子组件的描述 ，被叫做 *netlist*，是一种对门电路更详细的描述。



FPGA 与其他嵌入式计算机之间的区别在于 FPGA 中的程序是在数字逻辑级实现的，而嵌入式计算机中的程序，如微控制器或片上系统设备则是在汇编代码级实现的。为 FPGA 器件编写的算法是对逻辑门中的算法的描述，然后 FPGA 器件遵循描述以将其自身配置为算法。为微控制器编写的算法是汇编指令，处理器可以理解并采取相应的行动。





FPGA 适用于在常规计算机上运行的专用操作，且不适合成本高昂的情况，例如实时医学图像处理，巡航控制系统等等。这些应用程序需要使用常规处理器无法实现的高速处理，因为处理器在执行许多非专用指令（可能会增加数千条指令或更多指令）时浪费了大量时间来实现专门的操作。









